[importlinter]
root_package = immich_autotag
include_external_packages = True

[importlinter:contract:asset_cache_entry_no_imports]
name = Asset cache entry isolation
type = forbidden
source_modules =
    immich_autotag.assets.asset_cache_entry
forbidden_modules =
    immich_autotag.assets.asset_manager
    immich_autotag.assets.asset_response_wrapper
    immich_autotag.albums.album_collection_wrapper

[importlinter:contract:asset_response_wrapper_no_manager_or_album]
name = Asset response wrapper isolation
type = forbidden
source_modules =
    immich_autotag.assets.asset_response_wrapper
forbidden_modules =
    immich_autotag.assets.asset_manager
    immich_autotag.albums.album_collection_wrapper

[importlinter:contract:asset_manager_no_album_collection]
name = Asset manager isolation from albums
type = forbidden
source_modules =
    immich_autotag.assets.asset_manager
forbidden_modules =
    immich_autotag.albums.album_collection_wrapper

[importlinter:contract:logging_proxy_only_accesses_immich_proxy]
name = Only logging_proxy can access immich_proxy
type = forbidden
source_modules =
    immich_autotag
forbidden_modules =
    immich_autotag.api.immich_proxy

[importlinter:contract:immich_proxy_only_accesses_client]
name = Only immich_proxy can access immich_client
type = forbidden
source_modules =
    immich_autotag
forbidden_modules =
    immich_client
