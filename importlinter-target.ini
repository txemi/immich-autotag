[importlinter]
root_package = immich_autotag
include_external_packages = True

# TARGET level: Stricter architectural enforcement
# Includes all STANDARD contracts plus additional module isolation rules

# ============================================================================
# STANDARD CONTRACTS (Critical architectural boundaries)
# ============================================================================


[importlinter:contract:only_proxy_imports_client]
name = Only immich_proxy can import immich_client (STANDARD rule)
type = forbidden
source_modules = immich_autotag
forbidden_modules = immich_client
#ignore_imports = immich_autotag.api.immich_proxy* -> immich_client




[importlinter:contract:only_logging_proxy_imports_proxy]
name = Only logging_proxy can import immich_proxy (TARGET rule)
type = forbidden
source_modules = 
    immich_autotag
    immich_autotag.*
	immich_autotag.assets
	immich_autotag.albums
	immich_autotag.tags
	immich_autotag.report
	immich_autotag.permissions
#	immich_autotag.api.*
forbidden_modules = 
    immich_autotag.api.immich_proxy
    immich_autotag.api.immich_proxy.*
    immich_autotag.api.immich_proxy.*.*
    immich_autotag.api.immich_proxy.assets
    immich_autotag.api.immich_proxy.albums
    immich_autotag.api.immich_proxy.tags
    immich_autotag.api.immich_proxy.server
    immich_autotag.api.immich_proxy.duplicates
    immich_autotag.api.immich_proxy.permissions
    immich_autotag.api.immich_proxy.search
    immich_autotag.api.immich_proxy.users
    immich_autotag.api.immich_proxy.types
    immich_autotag.api.immich_proxy.client_types
    immich_autotag.api.immich_proxy.proxy_create_album    
#ignore_imports = immich_autotag.api.logging_proxy* -> immich_autotag.api.immich_proxy*

