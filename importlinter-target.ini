[importlinter]
root_package = immich_autotag
include_external_packages = True

# TARGET level: Stricter architectural enforcement
# Includes all STANDARD contracts plus additional module isolation rules

# ============================================================================
# STANDARD CONTRACTS (Critical architectural boundaries)
# ============================================================================

[importlinter:contract:logging_proxy_only_accesses_immich_proxy]
name = Only logging_proxy can access immich_proxy
type = forbidden
source_modules =
    immich_autotag
forbidden_modules =
    immich_autotag.api.immich_proxy

[importlinter:contract:immich_proxy_only_accesses_client]
name = Only immich_proxy can access immich_client
type = forbidden
source_modules =
    immich_autotag
forbidden_modules =
    immich_client

# ============================================================================
# TARGET CONTRACTS (Additional module isolation)
# ============================================================================

[importlinter:contract:no_direct_proxy_imports_from_albums]
name = Albums cannot import from immich_proxy submodules
type = forbidden
source_modules = immich_autotag.albums
forbidden_modules =
    immich_autotag.api.immich_proxy.albums
    immich_autotag.api.immich_proxy.assets
    immich_autotag.api.immich_proxy.search
    immich_autotag.api.immich_proxy.tags
    immich_autotag.api.immich_proxy.server
    immich_autotag.api.immich_proxy.duplicates
    immich_autotag.api.immich_proxy.permissions

[importlinter:contract:no_direct_proxy_imports_from_assets]
name = Assets cannot import from immich_proxy submodules
type = forbidden
source_modules = immich_autotag.assets
forbidden_modules =
    immich_autotag.api.immich_proxy.albums
    immich_autotag.api.immich_proxy.assets
    immich_autotag.api.immich_proxy.search
    immich_autotag.api.immich_proxy.tags
    immich_autotag.api.immich_proxy.server
    immich_autotag.api.immich_proxy.duplicates
    immich_autotag.api.immich_proxy.permissions

[importlinter:contract:no_direct_proxy_imports_from_tags]
name = Tags cannot import from immich_proxy submodules
type = forbidden
source_modules = immich_autotag.tags
forbidden_modules =
    immich_autotag.api.immich_proxy.albums
    immich_autotag.api.immich_proxy.assets
    immich_autotag.api.immich_proxy.search
    immich_autotag.api.immich_proxy.tags
    immich_autotag.api.immich_proxy.server
    immich_autotag.api.immich_proxy.duplicates
    immich_autotag.api.immich_proxy.permissions
